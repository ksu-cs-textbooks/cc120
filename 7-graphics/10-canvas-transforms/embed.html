




	
	
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CC 120 Textbook">
    <meta name="author" content="Nathan H. Bean">
    <title>Transforms and State :: K-State CC 120 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cc120/7-graphics/10-canvas-transforms/index.html" rel="canonical" type="text/html" title="Transforms and State :: K-State CC 120 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc120/7-graphics/10-canvas-transforms/index.xml" rel="alternate" type="application/rss+xml" title="Transforms and State :: K-State CC 120 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc120/7-graphics/10-canvas-transforms/index.print.html" rel="alternate" type="text/html" title="Transforms and State :: K-State CC 120 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc120/7-graphics/10-canvas-transforms/tele.html" rel="alternate" type="text/html" title="Transforms and State :: K-State CC 120 Textbook">
    
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/fontawesome-all.min.css?1701362934" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc120/css/fontawesome-all.min.css?1701362934" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/nucleus.css?1701362934" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/auto-complete.css?1701362934" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc120/css/auto-complete.css?1701362934" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/perfect-scrollbar.min.css?1701362934" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/fonts.css?1701362934" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc120/css/fonts.css?1701362934" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/theme.css?1701362934" rel="stylesheet">
    
    
    
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/theme-light-theme.css?1701362934" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/variant.css?1701362934" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/print.css?1701362934" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/ie.css?1701362934" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cc120/js/url.js?1701362934"></script>
    
    
    
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cc120/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cc120/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cc120/';
      window.variants && variants.init( [ 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cc120/css/custom.css?1701362934" rel="stylesheet">

    
  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cc120/7-graphics/10-canvas-transforms/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>Much like we can use CSS to apply transformations to HTML elements, we can use transforms to change how we draw into a canvas. The rendering context has a transformation matrix much like those we discussed in the CSS chapter, and it applies this transform to any point it is tasked with drawing.</p>
<p>We can replace the current transformation matrix with the <code>setTransform()</code> function, or multiply it by a new transformation (effectively combining the current transformation with the new one) by calling <code>transform()</code>.</p>
<p>With this in mind, it can be useful to know two other functions of the context, <code>save()</code> and <code>restore()</code>.  These save the current context state by pushing and popping from a stack.  Think of it as a pile of papers. When we call <code>save()</code> we write down the current state of the context object, and drop that paper in the stack.  When we call <code>restore()</code>, we take the topmost paper from the stack, and set context&rsquo;s state back to what was written on that sheet.</p>
<p>So what exactly constitutes the state of our rendering context? As you might imagine, this includes the transformation matrix we just talked about.  But it <em>also</em> includes all of the stroke and fill properties.</p>
<p>Now, back to the transforms.  As with CSS transforms, we can define the matrix ourselves, but there also exist a number of helper functions we can leverage, specifically:</p>
<ul>
<li><code>translate(tx, ty)</code> translates by <code>tx</code> in the x axis, and <code>ty</code> along the y</li>
<li><code>rotate(angle)</code> rotates around the z-axis by the supplied <code>angle</code> (specified in radians)</li>
<li><code>scale(sx,sy)</code> scales by <code>sx</code> along the x axis, and <code>sy</code> along the y axis. This is expressed as a decimal value: <code>1.0</code> indicates 100%, <code>0.5</code> for 50%, and <code>1.75</code> for 175%</li>
</ul>
<p><canvas id="example" width="500" height="300"></canvas></p>
<script>
  var canvas = document.getElementById('example');
  var ctx = canvas.getContext('2d');
  
  ctx.font = "40pt Tahoma";
  var metrics = ctx.measureText("Hello Canvas");
  var tx = 100 + metrics.width / 2;
  var ty = 180;
  
  ctx.translate(tx, ty);
  ctx.rotate(Math.PI/4);
  ctx.translate(-tx, -ty);

  ctx.strokeText("Hello Canvas", 100, 180);
</script>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">canvas</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;example&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;500&#34;</span> <span style="color:#a6e22e">height</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;300&#34;</span>&gt;&lt;/<span style="color:#f92672">canvas</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">canvas</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;example&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ctx</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">getContext</span>(<span style="color:#e6db74">&#39;2d&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">font</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;40pt Tahoma&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">metrics</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">measureText</span>(<span style="color:#e6db74">&#34;Hello Canvas&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tx</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">width</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ty</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">180</span>;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">translate</span>(<span style="color:#a6e22e">tx</span>, <span style="color:#a6e22e">ty</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">rotate</span>(Math.<span style="color:#a6e22e">PI</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">translate</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">tx</span>, <span style="color:#f92672">-</span><span style="color:#a6e22e">ty</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">strokeText</span>(<span style="color:#e6db74">&#34;Hello Canvas&#34;</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">180</span>);
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;</span></span></code></pre></div>
  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>In this example, we translate the text so that its center is at the origin <em>before</em> we rotate it, then translate it back. As any rotation we specify is around the origin, this makes it so the text is rotated around its center and stays on canvas, rather than rotating off the canvas.</p>
<p>Also notice that we call the transformation functions in the <em>opposite</em> order we want them applied.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cc120/js/clipboard.min.js?1701362934" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cc120/js/perfect-scrollbar.min.js?1701362934" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cc120/js/theme.js?1701362934" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cc120/js/embed-iframe.js?1701362934 defer"></script>
  </body>
</html>
